<!doctype HTML>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="css/bootstrap.min.css" rel="stylesheet">
    <link href="css/overrides.css" rel="stylesheet">
    <link rel="icon" href="/favicon.ico">
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>

    <script type="text/javascript">
        google.charts.load('current', {packages: ['corechart', 'line']});
google.charts.setOnLoadCallback(drawBasic);

        var data = getData("Year")
            var options = {
        hAxis: {
          title: 'Point in Time'
        },
        vAxis: {
          title: 'Price'
        },
          animation: {
          'startup': true,
          duration: 2000,
          easing: 'linear',
        },
          backgroundColor: {
              stroke: '#ff3333',
              strokeWidth: 10,
      },
          crosshair: {
              trigger: 'both',
              color: 'purple',
          },
      };
        
function drawBasic() {

    var chartData = google.visualization.arrayToDataTable(data);
      
      var chart = new google.visualization.LineChart(document.getElementById('chart_div'));

      chart.draw(chartData, options);
    }
        
    function getData(dataRange) {
        var dataArray = [
        ['Date', 'Stock Price']
        ];
        var urlBase = "https://query.yahooapis.com/v1/public/yql?q=";
        var urlEnd = "&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=";
        var urlMiddle = "select%20*%20from%20yahoo.finance.quote%20where%20symbol%20in%20(%22NTDOF%22)";
    
        var totalURL = urlBase + urlMiddle + urlEnd;
    
        var yql_query;
    
        
        if (dataRange == "Year") {
           yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2015-10-14" and endDate = "2016-10-14"';             
          //Represents full year data
      }
        else if (dataRange == "1sthalfyear") {
           yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2015-10-14" and endDate = "2016-04-14"';
            
          //Represents one half of the year
      }
        else if (dataRange == "2ndhalfyear") {
           yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2016-04-14" and endDate = "2016-10-14"';
            
           //Represents the other half of the year
      }
        else if (dataRange == "1stthirdyear") {
            yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2015-10-14" and endDate = "2016-02-14"';
            
            //Represents the 1st third of the year 
      }
        else if (dataRange == "2ndthirdyear") {
            yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2016-02-14" and endDate = "2016-06-14"';
            
              //Represemts the 2nd third of the year
      }
        else if (dataRange == "3rdthirdyear") {
            yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2016-06-14" and endDate = "2016-10-14"';
              //Represents the 3rd third of the year   
      }
        else if (dataRange == "1stquarteryear") {
             yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2015-10-14" and endDate = "2016-01-14"';
              //Represents the 1st quarter of the year
        }
          else if (dataRange == "2ndquarteryear") {
             yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2016-01-14" and endDate = "2016-04-14"';
 
              //Represents the 2nd quarter of the year
        }
          else if (dataRange == "3rdquarteryear") {
             yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2016-04-14" and endDate = "2016-07-14"';
              
              //Represents the 3rd quarter of the year
        }
           else if (dataRange == "4thquarteryear") {
             yql_query = 'select * from yahoo.finance.historicaldata where symbol = "NTDOF" and startDate = "2016-07-14" and endDate = "2016-10-14"';
               
              //Represents the 4th quarter of the year
        }
        var yql_query_str = urlBase + encodeURI(yql_query);
        var query_str_final = yql_query_str + "&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys";
        
      $.ajax({
        url: query_str_final,
        type: 'GET',
        success: function(result){
          var stockArray = result.query.results.quote;
          
            var index = 1;
          for (var i = stockArray.length -1; i >= 0; i--) {
          var currentObject = stockArray[i];
          console.log(currentObject.Close);
            //Push values of currentObject.date and currentObject.Close into dataArray
          var pushedArray = [currentObject.Date, parseFloat(currentObject.Close)];
          dataArray[index] = pushedArray;
            index++;
               }
            
                console.log(dataArray);
            data = dataArray
            var chartData = google.visualization.arrayToDataTable(data);
      
      var chart = new google.visualization.LineChart(document.getElementById('chart_div'));
    
      chart.draw(chartData, options);
            }
        });
    };
        function buttonPressed(buttonTitle) {
            getData(buttonTitle);
            
        };
        
    </script>
</head>
<body>
<div class="navbar navbar-default" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">Nintendo on the Stock Market</a>
        </div>
        <div class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="acitve">
                    <a href="index.html">Home</a>
                </li>
                <li>
                    <a href="about.html">About</a>
                </li>
                <li>
                    <a href="contact.html">Contact</a>
                </li>
            </ul>
        </div>
    </div>
</div>
    
<center><img src="http://www.eoinstanley.com/nintendo/nintendologo.png"alt="Nintendo Logo" align="middle"></center>
    
<div class="container">
    <div class="row">
        <div class="col-md-12">Data Visualization</div>
    </div>
    <div class="row">
        <div class="col-md-12" id="chart_div"></div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <button type="button" class="btn btn-default" onclick="buttonPressed('Year')">1Y</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('1sthalfyear')">6M</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('2ndhalfyear')">6M</button>
            <button type="button" class="btn btn-default"
onclick="buttonPressed('1stthirdyear')">4M</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('2ndthirdyear')">4M</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('3rdthirdyear')">4M</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('1stquarteryear')">3M</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('2ndquarteryear')">3M</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('3rdquarteryear')">3M</button>
            <button type="button" class="btn btn-default" onclick="buttonPressed('4thquarteryear')">3M</button>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <p id="change"></p>
        </div>
    </div>
</div>
    
<script src="js/bootstrap.min.js"></script>
<script type="text/javascript">
    
    //https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20yahoo.finance.quote%20where%20symbol%20in%20(%22NTDOF%22)&format=json&diagnostics=true&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys&callback=



</script>
    
</body>
</html>